# Modello M1 - Analisi di Regressione Lineare

## Obiettivo del Codice

Il file `m1.py` implementa una **regressione lineare semplice** per analizzare la relazione tra l'**Indice di Massa Corporea (BMI)** e i **costi assicurativi sanitari** utilizzando Python con integrazione R tramite la libreria `rpy2`.

### Variabili Analizzate
- **Variabile indipendente (x1)**: BMI (Body Mass Index)
- **Variabile dipendente (y)**: Charges (costi assicurativi)

### Modello di Regressione
Il modello implementato è: **charges ~ bmi**

## Dataset

Il dataset `insurance.csv` contiene informazioni su 1338 assicurati con le seguenti variabili:

- **age**: Età dell'assicurato
- **sex**: Sesso (male/female)
- **bmi**: Indice di Massa Corporea (Body Mass Index)
- **children**: Numero di figli a carico
- **smoker**: Stato di fumatore (yes/no)
- **region**: Regione geografica (southwest, southeast, northwest, northeast)
- **charges**: Costi assicurativi (variabile target)

## Metodologia

### 1. Caricamento dei Dati
- Lettura del dataset `insurance.csv` tramite R
- Selezione delle variabili BMI e charges per l'analisi

### 2. Analisi Esplorativa
- **Statistiche descrittive** delle variabili
- **Calcolo della varianza** per entrambe le variabili
- **Analisi della correlazione** tra BMI e costi assicurativi

### 3. Visualizzazioni Generate
Il codice produce tre grafici principali:

#### Istogramma dei Costi Assicurativi
![Istogramma Charges](hist_charges.png)

Questo istogramma mostra la distribuzione dei costi assicurativi nel dataset, evidenziando la forma della distribuzione e la presenza di eventuali outliers.

#### Scatter Plot: BMI vs Costi Assicurativi
![Scatter Plot BMI vs Charges](m1_scatter_plot.png)

Il grafico scatter mostra la relazione tra BMI e costi assicurativi, con la **linea di regressione rossa** che rappresenta il modello lineare stimato.

#### Analisi Grafica dei Residui
![Analisi dei Residui](m1_residuals.png)

Il grafico dei residui fornisce informazioni cruciali sulla validità delle assunzioni del modello di regressione lineare:

**Interpretazione dell'Analisi dei Residui:**

1. **Pattern dei Residui vs Valori Predetti**:
   - I residui dovrebbero essere distribuiti casualmente attorno allo zero
   - La presenza di pattern sistematici indica violazioni delle assunzioni del modello
   - Eventuali tendenze curve suggeriscono relazioni non lineari non catturate dal modello

2. **Omoschedasticità (Varianza Costante)**:
   - I residui dovrebbero avere varianza costante lungo tutti i valori predetti
   - Un pattern "a imbuto" indica eteroschedasticità (varianza non costante)
   - La presenza di eteroschedasticità compromette l'efficienza delle stime

3. **Normalità dei Residui**:
   - I residui dovrebbero seguire una distribuzione normale
   - Deviazioni dalla normalità possono influenzare l'affidabilità dei test statistici
   - Outliers significativi sono visibili come punti distanti dalla distribuzione principale

4. **Identificazione di Outliers**:
   - Punti con residui standardizzati |z| > 2.5-3 sono considerati outliers
   - Gli outliers possono influenzare significativamente i parametri del modello
   - La rimozione o il trattamento degli outliers potrebbe migliorare le prestazioni del modello

**Diagnosi Specifica per il Modello M1**:
- La distribuzione dei residui conferma la presenza di eteroschedasticità
- Si osservano alcuni outliers significativi che potrebbero influenzare il modello
- Il pattern dei residui suggerisce che una relazione lineare semplice potrebbe non essere ottimale
- La varianza dei residui tende ad aumentare con i valori predetti, indicando la necessità di trasformazioni o modelli più complessi

### 4. Modello di Regressione Lineare
- Stima dei parametri del modello lineare
- Analisi dei residui
- Valutazione della qualità del modello (R-squared, p-value)

## Risultati Dettagliati del Modello M1

### Statistical Summary of Variables
```
       y               x1       
 Min.   : 1122   Min.   :15.96  
 1st Qu.: 4740   1st Qu.:26.30  
 Median : 9382   Median :30.40  
 Mean   :13270   Mean   :30.66  
 3rd Qu.:16640   3rd Qu.:34.69  
 Max.   :63770   Max.   :53.13  
```

**Interpretazione delle Statistiche Descrittive:**
- **Charges (y)**: I costi assicurativi variano da $1,122 a $63,770, con una media di $13,270
- **BMI (x1)**: Il BMI varia da 15.96 a 53.13, con una media di 30.66
- La distribuzione dei costi mostra una forte asimmetria positiva (mediana < media)

### Variance of Variables
```
             y          x1
y  146652372.2 14647.30443
x1     14647.3    37.18788
```

**Analisi della Varianza:**
- **Varianza dei costi (y)**: 146,652,372.2 (elevata variabilità)
- **Varianza del BMI (x1)**: 37.19 (moderata variabilità)
- **Covarianza**: 14,647.3 (relazione positiva tra le variabili)

### Correlation Index between Variables
```
          y       x1
y  1.000000 0.198341
x1 0.198341 1.000000
```

**Correlazione di Pearson:**
- **Coefficiente di correlazione**: r = 0.198
- **Interpretazione**: Correlazione positiva debole tra BMI e costi assicurativi
- Solo il 3.93% della varianza nei costi è spiegata dalla varianza nel BMI (r² = 0.198²)

### Summary of Linear Model M1

```
lm(formula = y ~ x1)

Residuals:
   Min     1Q Median     3Q    Max 
-20956  -8118  -3757   4722  49442 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  1192.94    1664.80   0.717    0.474    
x1            393.87      53.25   7.397 2.46e-13 ***

---

Residual standard error: 11870 on 1336 degrees of freedom
Multiple R-squared:  0.03934,   Adjusted R-squared:  0.03862 
F-statistic: 54.71 on 1 and 1336 DF,  p-value: 2.459e-13
```

## Risultati Principali

### Equazione del Modello
**charges = 1192.94 + 393.87 × BMI**

### Interpretazione Dettagliata dei Coefficienti

#### Intercetta (1192.94)
- **Valore**: $1,192.94
- **Errore Standard**: $1,664.80
- **t-value**: 0.717
- **p-value**: 0.474 (non significativo)
- **Interpretazione**: Costo assicurativo stimato per una persona con BMI = 0 (valore teorico)

#### Coefficiente BMI (393.87)
- **Valore**: $393.87 per unità di BMI
- **Errore Standard**: $53.25
- **t-value**: 7.397
- **p-value**: 2.46e-13 (altamente significativo ***)
- **Interpretazione**: **Per ogni aumento di 1 unità di BMI, i costi assicurativi aumentano in media di circa $394**

### Qualità del Modello

#### Coefficiente di Determinazione
- **R-squared**: 0.03934 (3.93%)
- **Adjusted R-squared**: 0.03862 (3.86%)
- **Interpretazione**: **La varianza spiegata dal modello è solo del 3.93%, è dunque un modello debole**

#### Test F
- **F-statistic**: 54.71 su 1 e 1336 gradi di libertà
- **p-value**: 2.459e-13 (altamente significativo)
- **Conclusione**: Il modello è statisticamente significativo nel complesso

#### Analisi dei Residui
- **Errore Standard Residuo**: $11,870
- **Range dei Residui**: da -$20,956 a +$49,442
- **Distribuzione**: I residui mostrano una distribuzione asimmetrica con alcuni outliers significativi

## Limitazioni e Osservazioni Critiche

Il modello M1 presenta alcune limitazioni significative:

1. **Bassa Capacità Predittiva**: R² = 3.93% indica che il modello spiega solo una piccola frazione della variabilità nei costi
2. **Intercetta Non Significativa**: Il p-value dell'intercetta (0.474) indica che non è statisticamente significativa
3. **Residui Eterogenei**: L'ampio range dei residui suggerisce varianza non costante
4. **Variabili Omesse**: Il modello non considera altre variabili importanti come età, stato di fumatore, regione, ecc.
5. **Relazione Lineare Semplice**: Non considera possibili relazioni non lineari o interazioni

## Conclusioni

Sebbene esista una relazione statisticamente significativa tra BMI e costi assicurativi (p < 0.001), il modello semplice di regressione lineare con solo il BMI come predittore presenta severe limitazioni:

- **Significatività Statistica**: Il coefficiente del BMI è altamente significativo
- **Rilevanza Pratica**: L'effetto è economicamente rilevante (~$394 per unità di BMI)
- **Capacità Predittiva Limitata**: Solo il 3.93% della varianza è spiegata
- **Necessità di Modelli Più Complessi**: Sono necessari modelli multivariati che includano altre variabili esplicative per ottenere una migliore capacità predittiva

Il modello M1 rappresenta un punto di partenza per l'analisi, ma evidenzia chiaramente la necessità di sviluppare modelli più sofisticati per una comprensione completa dei fattori che influenzano i costi assicurativi sanitari.